{"schemaVersion":{"patch":0,"minor":3,"major":0},"metadata":{"role":"article","images":[{"identifier":"host-server-card.jpg","type":"card"}],"roleHeading":"Article","modules":[{"name":"VernissageServer"}],"title":"Host Vernissage Server (API)"},"seeAlsoSections":[{"title":"Essentials","identifiers":["doc:\/\/VernissageServer\/documentation\/VernissageServer\/HostVernissageWeb","doc:\/\/VernissageServer\/documentation\/VernissageServer\/DockerContainers","doc:\/\/VernissageServer\/documentation\/VernissageServer\/BuildDocumentation","doc:\/\/VernissageServer\/documentation\/VernissageServer\/ContentFeeds"],"anchor":"Essentials","generated":true}],"abstract":[{"type":"text","text":"Application which is main API component for Vernissage photos sharing platform."}],"sections":[],"primaryContentSections":[{"content":[{"type":"heading","level":2,"anchor":"Overview","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Vernissage API server is created in "},{"isActive":true,"type":"reference","identifier":"https:\/\/www.swift.org\/"},{"type":"text","text":" language with "},{"identifier":"https:\/\/vapor.codes","type":"reference","isActive":true},{"type":"text","text":" framework."},{"type":"text","text":" "},{"type":"text","text":"We can run it in all operating systems supporting "},{"code":"Swift","type":"codeVoice"},{"type":"text","text":" and "},{"code":"Vapor","type":"codeVoice"},{"text":".","type":"text"}]},{"type":"heading","level":2,"anchor":"Prerequisites","text":"Prerequisites"},{"inlineContent":[{"text":"Running the application requires installing ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/www.swift.org\/install\/"},{"text":".","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Three libraries are required to build\/run the Vernissage API application: ","type":"text"},{"type":"reference","identifier":"https:\/\/github.com\/libgd\/libgd","isActive":true},{"text":", ","type":"text"},{"identifier":"https:\/\/github.com\/libexif\/libexif","isActive":true,"type":"reference"},{"type":"text","text":" and "},{"type":"reference","identifier":"https:\/\/libiptcdata.sourceforge.net","isActive":true},{"text":".","type":"text"},{"type":"text","text":" "},{"type":"text","text":"These libraries are responsible mostly for image manipulation (resizing, converting, exif metadata, etc.)."}],"type":"paragraph"},{"anchor":"macOs","level":3,"text":"macOs","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Using "},{"type":"reference","identifier":"https:\/\/brew.sh","isActive":true},{"type":"text","text":" you need to run following command:"}]},{"code":["$ brew install gd libexif libiptcdata"],"syntax":"bash","type":"codeListing"},{"level":3,"type":"heading","text":"Linux","anchor":"Linux"},{"inlineContent":[{"type":"text","text":"If youâ€™re using Linux you need to run following command as root."}],"type":"paragraph"},{"code":["$ apt install -y libgd-dev libexif-dev libiptcdata0-dev"],"type":"codeListing","syntax":"bash"},{"type":"heading","level":2,"text":"Getting started","anchor":"Getting-started"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Below are all the commands necessary to run the API part of the Vernissage."}]},{"code":["$ git clone https:\/\/github.com\/VernissageApp\/VernissageServer.git","$ cd VernissageServer","$ swift run"],"type":"codeListing","syntax":"bash"},{"type":"paragraph","inlineContent":[{"text":"API should start. Configuration will be read from ","type":"text"},{"type":"codeVoice","code":"appsettings.json"},{"type":"text","text":" file. SQLite database will be used. You can sign in using default "},{"code":"admin","type":"codeVoice"},{"text":" account (with password: ","type":"text"},{"code":"admin","type":"codeVoice"},{"type":"text","text":"). For example:"}]},{"syntax":"bash","type":"codeListing","code":["$ curl --location 'http:\/\/localhost:8080\/api\/v1\/account\/login' \\","--header 'Accept: application\/json' \\","--header 'Content-Type: application\/json' \\","--data-raw '{","    \"userNameOrEmail\": \"admin\",","    \"password\": \"admin\"","}'"]},{"inlineContent":[{"type":"text","text":"Request will return JSON:"}],"type":"paragraph"},{"type":"codeListing","code":["{","    \"accessToken\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzUxMiJ9.eyJpZCI6IjcyNTA3Mjk3NzcyNjEyMzYyMjUiLCJhcHBsaWNhdGlvbiI6IlZlcm5pc3NhZ2UgMS4wLjAtYWxwaGExIiwicm9sZXMiOlsiYWRtaW5pc3RyYXRvciJdLCJ1c2VyTmFtZSI6ImFkbWluIiwibmFtZSI6IkFkbWluaXN0cmF0b3IiLCJlbWFpbCI6ImFkbWluQGxvY2FsaG9zdCIsImV4cCI6MTcwNjE2OTE1Mi4zODk5NTMxfQ.Z87v9HvfBM6fn6F8fu06ToPShT9F55G74wL676SLmSdLMzyz3ykfsmS-GDNIqfUatfwdBvSxQgpjUO6IzYAuQKZ925tdN8DwN6kVAEa2mJLlntc66qAkQSiPeXYEl29Cgbg6TuAvxghWVO5PVliMG8mxO7uwSFDN095mNxbee8x8P-ogL176vXBhJ_rWcm1fY7_n-qSn6XN2GbgjiywnOZfvHNNtLvbikcpJeIAzHH-BlXolWsUauuZGZBeFv5TuBr13r5PZfVar0FH9Uwj39w5DV3jxlwRPyejux4LL96dvrEsP4Btx88c3SSLyxm1REfRR_wKoUoXK8iVqfBU6TQ\",","    \"refreshToken\": \"U8zMqw1tGHqIk0cUXmvAEcwYIpsQlwWUxHa0fnXbu\",","    \"xsrfToken\": \"OpjXDt6VwT0HNrLWPhcp4yXqAhdhngWS2i1Ilt0v0dNdBpLkhU24XGT4dj4W3EJES\"","}"],"syntax":"json"},{"inlineContent":[{"text":"After successfully sign in you can use other endpoints (with ","type":"text"},{"code":"Authentication: Bearer","type":"codeVoice"},{"text":" header).","type":"text"}],"type":"paragraph"},{"anchor":"Custom-configuration","type":"heading","level":2,"text":"Custom configuration"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In local development environment you can create "},{"type":"codeVoice","code":"appsettings.local.json"},{"type":"text","text":" file (near "},{"type":"codeVoice","code":"appsettings.json"},{"text":" file). This file can look like that:","type":"text"}]},{"syntax":"json","type":"codeListing","code":["{","    \"vernissage\": {","        \"baseAddress\": \"http:\/\/localhost:8080\",","        \"connectionString\": \"postgres:\/\/postgres:secretpass@localhost:5432\/postgres\",","        \"queueUrl\": \"redis:\/\/127.0.0.1:6379\",","        \"s3Address\": \"https:\/\/s3.eu-central-1.amazonaws.com\",","        \"s3Region\": \"eu-central-1\",","        \"s3Bucket\": \"your-bucket-test\",","        \"s3AccessKeyId\": \"ASDA8AS8HSDSU\",","        \"s3SecretAccessKey\": \"DSfEaBUYIhoouHhigygGtldDpLesmXCz10ICe0F\"","    }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Here you can configure three external resources:"}]},{"items":[{"content":[{"inlineContent":[{"code":"connectionString","type":"codeVoice"},{"text":" - you can use SQLite or Postgres database connection string","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"queueUrl"},{"type":"text","text":" - URL to Redis in memory data store (used as cache and queue by Vernissage)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"s3*"},{"type":"text","text":" - configuration of S3 storage. Here you can use any external S3 compatible cloud storage or "},{"type":"reference","isActive":true,"identifier":"https:\/\/min.io"},{"type":"text","text":" docker ("},{"identifier":"https:\/\/hub.docker.com\/r\/minio\/minio","isActive":true,"type":"reference"},{"text":")","type":"text"}]}]}],"type":"unorderedList"},{"type":"aside","name":"Note","content":[{"inlineContent":[{"type":"text","text":"If the "},{"code":"s3Region","type":"codeVoice"},{"type":"text","text":" variable is set, it causes the other settings to be overwritten and use Amazon AWS S3."}],"type":"paragraph"}],"style":"note"},{"inlineContent":[{"type":"text","text":"In production environment you can override configuration parameters by environment variables. For example if you want to set custom "},{"type":"codeVoice","code":"baseAddress"},{"text":" you have to define variable: ","type":"text"},{"type":"codeVoice","code":"VERNISSAGE_BASEADDRESS"},{"type":"text","text":", etc."}],"type":"paragraph"},{"anchor":"Log-level","level":2,"text":"Log level","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The system console is the only location where logs are displayed. Additionally, we can modify the default login level by setting a system environment variable:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"LOG_LEVEL","type":"codeVoice"},{"text":" - more information about log levels you can find ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/docs.vapor.codes\/basics\/logging\/"},{"type":"text","text":"."}]}]}]},{"text":"Docker","type":"heading","level":2,"anchor":"Docker"},{"type":"paragraph","inlineContent":[{"text":"In production environments, it is best to use a ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/hub.docker.com\/repository\/docker\/mczachurski\/vernissage-server"},{"text":".","type":"text"}]}],"kind":"content"}],"variants":[{"paths":["\/documentation\/vernissageserver\/hostvernissageserver"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/VernissageServer\/documentation\/VernissageServer\/HostVernissageServer","interfaceLanguage":"swift"},"kind":"article","hierarchy":{"paths":[["doc:\/\/VernissageServer\/documentation\/VernissageServer"]]},"references":{"https://www.swift.org/install/":{"titleInlineContent":[{"text":"Swift","type":"text"}],"url":"https:\/\/www.swift.org\/install\/","type":"link","title":"Swift","identifier":"https:\/\/www.swift.org\/install\/"},"https://brew.sh":{"title":"Homebrew","url":"https:\/\/brew.sh","identifier":"https:\/\/brew.sh","titleInlineContent":[{"type":"text","text":"Homebrew"}],"type":"link"},"doc://VernissageServer/documentation/VernissageServer/BuildDocumentation":{"type":"topic","identifier":"doc:\/\/VernissageServer\/documentation\/VernissageServer\/BuildDocumentation","url":"\/documentation\/vernissageserver\/builddocumentation","abstract":[{"type":"text","text":"This documentation is created by DocC tool."}],"role":"article","title":"Build the documentation","kind":"article"},"https://github.com/libexif/libexif":{"title":"libexif","url":"https:\/\/github.com\/libexif\/libexif","identifier":"https:\/\/github.com\/libexif\/libexif","titleInlineContent":[{"type":"text","text":"libexif"}],"type":"link"},"https://min.io":{"title":"minio","url":"https:\/\/min.io","identifier":"https:\/\/min.io","titleInlineContent":[{"text":"minio","type":"text"}],"type":"link"},"https://github.com/libgd/libgd":{"title":"GD","url":"https:\/\/github.com\/libgd\/libgd","identifier":"https:\/\/github.com\/libgd\/libgd","titleInlineContent":[{"text":"GD","type":"text"}],"type":"link"},"https://docs.vapor.codes/basics/logging/":{"title":"here","url":"https:\/\/docs.vapor.codes\/basics\/logging\/","identifier":"https:\/\/docs.vapor.codes\/basics\/logging\/","titleInlineContent":[{"type":"text","text":"here"}],"type":"link"},"https://www.swift.org/":{"title":"Swift","url":"https:\/\/www.swift.org\/","identifier":"https:\/\/www.swift.org\/","titleInlineContent":[{"text":"Swift","type":"text"}],"type":"link"},"doc://VernissageServer/documentation/VernissageServer":{"abstract":[{"text":"Application which is main API component for Vernissage photos sharing platform.","type":"text"}],"type":"topic","kind":"symbol","title":"VernissageServer","identifier":"doc:\/\/VernissageServer\/documentation\/VernissageServer","role":"collection","url":"\/documentation\/vernissageserver"},"https://hub.docker.com/repository/docker/mczachurski/vernissage-server":{"title":"docker image","url":"https:\/\/hub.docker.com\/repository\/docker\/mczachurski\/vernissage-server","identifier":"https:\/\/hub.docker.com\/repository\/docker\/mczachurski\/vernissage-server","titleInlineContent":[{"text":"docker image","type":"text"}],"type":"link"},"doc://VernissageServer/documentation/VernissageServer/ContentFeeds":{"url":"\/documentation\/vernissageserver\/contentfeeds","title":"Content feeds (RSS\/Atom)","identifier":"doc:\/\/VernissageServer\/documentation\/VernissageServer\/ContentFeeds","type":"topic","kind":"article","abstract":[{"type":"strong","inlineContent":[{"type":"text","text":"RSS"}]},{"type":"text","text":" (Really Simple Syndication) and "},{"type":"strong","inlineContent":[{"type":"text","text":"Atom"}]},{"type":"text","text":" are widely used web feed formats that allow users to subscribe to updates from websites in an organized and automated way. These protocols enable seamless content consumption through feed readers, making it easier to stay up to date with new posts, images, and other shared content without manually visiting a website."}],"role":"article"},"https://libiptcdata.sourceforge.net":{"title":"libiptcdata","url":"https:\/\/libiptcdata.sourceforge.net","identifier":"https:\/\/libiptcdata.sourceforge.net","titleInlineContent":[{"type":"text","text":"libiptcdata"}],"type":"link"},"host-server-card.jpg":{"alt":null,"identifier":"host-server-card.jpg","variants":[{"url":"\/images\/VernissageServer\/host-server-card@2x.jpg","traits":["2x","light"]}],"type":"image"},"https://hub.docker.com/r/minio/minio":{"title":"https:\/\/hub.docker.com\/r\/minio\/minio","url":"https:\/\/hub.docker.com\/r\/minio\/minio","identifier":"https:\/\/hub.docker.com\/r\/minio\/minio","titleInlineContent":[{"type":"text","text":"https:\/\/hub.docker.com\/r\/minio\/minio"}],"type":"link"},"doc://VernissageServer/documentation/VernissageServer/DockerContainers":{"type":"topic","url":"\/documentation\/vernissageserver\/dockercontainers","identifier":"doc:\/\/VernissageServer\/documentation\/VernissageServer\/DockerContainers","title":"Hosting Vernissage in Docker containers","role":"article","abstract":[{"text":"This documentation describes how to run Vernissage in your custom Docker container hosting provider using ","type":"text"},{"type":"codeVoice","code":"docker compose"},{"type":"text","text":"."}],"kind":"article"},"https://vapor.codes":{"titleInlineContent":[{"text":"Vapor","type":"text"}],"url":"https:\/\/vapor.codes","type":"link","title":"Vapor","identifier":"https:\/\/vapor.codes"},"host-web-card.jpg":{"variants":[{"traits":["2x","light"],"url":"\/images\/VernissageServer\/host-web-card@2x.jpg"}],"type":"image","identifier":"host-web-card.jpg","alt":"The profile image for web documentation."},"doc://VernissageServer/documentation/VernissageServer/HostVernissageWeb":{"type":"topic","identifier":"doc:\/\/VernissageServer\/documentation\/VernissageServer\/HostVernissageWeb","url":"\/documentation\/vernissageserver\/hostvernissageweb","abstract":[{"type":"text","text":"Application which is Web component for Vernissage photos sharing platform."}],"role":"article","title":"Host Vernissage WEB","kind":"article","images":[{"identifier":"host-web-card.jpg","type":"card"}]}}}