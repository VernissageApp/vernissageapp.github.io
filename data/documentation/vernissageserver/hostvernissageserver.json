{"kind":"article","primaryContentSections":[{"content":[{"level":2,"anchor":"Overview","text":"Overview","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Vernissage API server is created in ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/www.swift.org\/"},{"text":" language with ","type":"text"},{"type":"reference","identifier":"https:\/\/vapor.codes","isActive":true},{"type":"text","text":" framework."},{"type":"text","text":" "},{"type":"text","text":"We can run it in all operating systems supporting "},{"type":"codeVoice","code":"Swift"},{"type":"text","text":" and "},{"code":"Vapor","type":"codeVoice"},{"type":"text","text":"."}]},{"text":"Prerequisites","level":2,"type":"heading","anchor":"Prerequisites"},{"type":"paragraph","inlineContent":[{"text":"Running the application requires installing ","type":"text"},{"type":"reference","identifier":"https:\/\/www.swift.org\/install\/","isActive":true},{"text":".","type":"text"}]},{"inlineContent":[{"type":"text","text":"Three libraries are required to build\/run the Vernissage API application: "},{"type":"reference","identifier":"https:\/\/github.com\/libgd\/libgd","isActive":true},{"type":"text","text":", "},{"identifier":"https:\/\/github.com\/libexif\/libexif","type":"reference","isActive":true},{"text":" and ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/libiptcdata.sourceforge.net"},{"text":".","type":"text"},{"type":"text","text":" "},{"text":"These libraries are responsible mostly for image manipulation (resizing, converting, exif metadata, etc.).","type":"text"}],"type":"paragraph"},{"text":"macOs","level":3,"anchor":"macOs","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Using ","type":"text"},{"identifier":"https:\/\/brew.sh","isActive":true,"type":"reference"},{"type":"text","text":" you need to run following command:"}]},{"syntax":"bash","type":"codeListing","code":["$ brew install gd libexif libiptcdata"]},{"level":3,"text":"Linux","type":"heading","anchor":"Linux"},{"inlineContent":[{"text":"If youâ€™re using Linux you need to run following command as root.","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["$ apt install -y libgd-dev libexif-dev libiptcdata0-dev"],"syntax":"bash"},{"type":"heading","level":2,"anchor":"Getting-started","text":"Getting started"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Below are all the commands necessary to run the API part of the Vernissage."}]},{"syntax":"bash","type":"codeListing","code":["$ git clone https:\/\/github.com\/VernissageApp\/VernissageServer.git","$ cd VernissageServer","$ swift run"]},{"inlineContent":[{"type":"text","text":"API should start. Configuration will be read from "},{"code":"appsettings.json","type":"codeVoice"},{"type":"text","text":" file. SQLite database will be used. You can sign in using default "},{"type":"codeVoice","code":"admin"},{"text":" account (with password: ","type":"text"},{"type":"codeVoice","code":"admin"},{"text":"). For example:","type":"text"}],"type":"paragraph"},{"code":["$ curl --location 'http:\/\/localhost:8080\/api\/v1\/account\/login' \\","--header 'Accept: application\/json' \\","--header 'Content-Type: application\/json' \\","--data-raw '{","    \"userNameOrEmail\": \"admin\",","    \"password\": \"admin\"","}'"],"syntax":"bash","type":"codeListing"},{"inlineContent":[{"type":"text","text":"Request will return JSON:"}],"type":"paragraph"},{"syntax":"json","code":["{","    \"accessToken\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzUxMiJ9.eyJpZCI6IjcyNTA3Mjk3NzcyNjEyMzYyMjUiLCJhcHBsaWNhdGlvbiI6IlZlcm5pc3NhZ2UgMS4wLjAtYWxwaGExIiwicm9sZXMiOlsiYWRtaW5pc3RyYXRvciJdLCJ1c2VyTmFtZSI6ImFkbWluIiwibmFtZSI6IkFkbWluaXN0cmF0b3IiLCJlbWFpbCI6ImFkbWluQGxvY2FsaG9zdCIsImV4cCI6MTcwNjE2OTE1Mi4zODk5NTMxfQ.Z87v9HvfBM6fn6F8fu06ToPShT9F55G74wL676SLmSdLMzyz3ykfsmS-GDNIqfUatfwdBvSxQgpjUO6IzYAuQKZ925tdN8DwN6kVAEa2mJLlntc66qAkQSiPeXYEl29Cgbg6TuAvxghWVO5PVliMG8mxO7uwSFDN095mNxbee8x8P-ogL176vXBhJ_rWcm1fY7_n-qSn6XN2GbgjiywnOZfvHNNtLvbikcpJeIAzHH-BlXolWsUauuZGZBeFv5TuBr13r5PZfVar0FH9Uwj39w5DV3jxlwRPyejux4LL96dvrEsP4Btx88c3SSLyxm1REfRR_wKoUoXK8iVqfBU6TQ\",","    \"refreshToken\": \"U8zMqw1tGHqIk0cUXmvAEcwYIpsQlwWUxHa0fnXbu\",","    \"xsrfToken\": \"OpjXDt6VwT0HNrLWPhcp4yXqAhdhngWS2i1Ilt0v0dNdBpLkhU24XGT4dj4W3EJES\"","}"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"After successfully sign in you can use other endpoints (with ","type":"text"},{"type":"codeVoice","code":"Authentication: Bearer"},{"text":" header).","type":"text"}]},{"text":"Custom configuration","level":2,"anchor":"Custom-configuration","type":"heading"},{"inlineContent":[{"text":"In local development environment you can create ","type":"text"},{"code":"appsettings.local.json","type":"codeVoice"},{"text":" file (near ","type":"text"},{"type":"codeVoice","code":"appsettings.json"},{"type":"text","text":" file). This file can look like that:"}],"type":"paragraph"},{"type":"codeListing","syntax":"json","code":["{","    \"vernissage\": {","        \"baseAddress\": \"http:\/\/localhost:8080\",","        \"connectionString\": \"postgres:\/\/postgres:secretpass@localhost:5432\/postgres\",","        \"queueUrl\": \"redis:\/\/127.0.0.1:6379\",","        \"s3Address\": \"https:\/\/s3.eu-central-1.amazonaws.com\",","        \"s3Region\": \"eu-central-1\",","        \"s3Bucket\": \"your-bucket-test\",","        \"s3AccessKeyId\": \"ASDA8AS8HSDSU\",","        \"s3SecretAccessKey\": \"DSfEaBUYIhoouHhigygGtldDpLesmXCz10ICe0F\"","    }","}"]},{"type":"paragraph","inlineContent":[{"text":"Here you can configure three external resources:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"connectionString"},{"text":" - you can use SQLite or Postgres database connection string","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"queueUrl","type":"codeVoice"},{"type":"text","text":" - URL to Redis in memory data store (used as cache and queue by Vernissage)"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"s3*"},{"type":"text","text":" - configuration of S3 storage. Here you can use any external S3 compatible cloud storage or "},{"type":"reference","identifier":"https:\/\/min.io","isActive":true},{"text":" docker (","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/hub.docker.com\/r\/minio\/minio"},{"type":"text","text":")"}],"type":"paragraph"}]}]},{"type":"aside","style":"note","name":"Note","content":[{"inlineContent":[{"text":"If the ","type":"text"},{"type":"codeVoice","code":"s3Region"},{"type":"text","text":" variable is set, it causes the other settings to be overwritten and use Amazon AWS S3."}],"type":"paragraph"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In production environment you can override configuration parameters by environment variables. For example if you want to set custom "},{"code":"baseAddress","type":"codeVoice"},{"text":" you have to define variable: ","type":"text"},{"type":"codeVoice","code":"VERNISSAGE_BASEADDRESS"},{"type":"text","text":", etc."}]},{"text":"Log level","anchor":"Log-level","type":"heading","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"The system console is the only location where logs are displayed. Additionally, we can modify the default login level by setting a system environment variable:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"LOG_LEVEL"},{"type":"text","text":" - more information about log levels you can find "},{"type":"reference","identifier":"https:\/\/docs.vapor.codes\/basics\/logging\/","isActive":true},{"text":".","type":"text"}]}]}]},{"anchor":"Docker","level":2,"type":"heading","text":"Docker"},{"type":"paragraph","inlineContent":[{"text":"In production environments, it is best to use a ","type":"text"},{"type":"reference","identifier":"https:\/\/hub.docker.com\/repository\/docker\/mczachurski\/vernissage-server","isActive":true},{"text":".","type":"text"}]}],"kind":"content"}],"variants":[{"paths":["\/documentation\/vernissageserver\/hostvernissageserver"],"traits":[{"interfaceLanguage":"swift"}]}],"sections":[],"identifier":{"url":"doc:\/\/VernissageServer\/documentation\/VernissageServer\/HostVernissageServer","interfaceLanguage":"swift"},"metadata":{"title":"Host Vernissage Server (API)","images":[{"type":"card","identifier":"host-server-card.jpg"}],"roleHeading":"Article","role":"article","modules":[{"name":"VernissageServer"}]},"abstract":[{"text":"Application which is main API component for Vernissage photos sharing platform.","type":"text"}],"schemaVersion":{"patch":0,"minor":3,"major":0},"hierarchy":{"paths":[["doc:\/\/VernissageServer\/documentation\/VernissageServer"]]},"seeAlsoSections":[{"generated":true,"anchor":"Essentials","identifiers":["doc:\/\/VernissageServer\/documentation\/VernissageServer\/HostVernissageWeb","doc:\/\/VernissageServer\/documentation\/VernissageServer\/DockerContainers","doc:\/\/VernissageServer\/documentation\/VernissageServer\/BuildDocumentation"],"title":"Essentials"}],"references":{"https://github.com/libgd/libgd":{"title":"GD","titleInlineContent":[{"text":"GD","type":"text"}],"type":"link","identifier":"https:\/\/github.com\/libgd\/libgd","url":"https:\/\/github.com\/libgd\/libgd"},"https://brew.sh":{"title":"Homebrew","titleInlineContent":[{"text":"Homebrew","type":"text"}],"type":"link","identifier":"https:\/\/brew.sh","url":"https:\/\/brew.sh"},"doc://VernissageServer/documentation/VernissageServer":{"url":"\/documentation\/vernissageserver","type":"topic","role":"collection","identifier":"doc:\/\/VernissageServer\/documentation\/VernissageServer","title":"VernissageServer","abstract":[{"text":"Application which is main API component for Vernissage photos sharing platform.","type":"text"}],"kind":"symbol"},"doc://VernissageServer/documentation/VernissageServer/BuildDocumentation":{"title":"Build the documentation","role":"article","abstract":[{"text":"This documentation is created by DocC tool.","type":"text"}],"type":"topic","url":"\/documentation\/vernissageserver\/builddocumentation","kind":"article","identifier":"doc:\/\/VernissageServer\/documentation\/VernissageServer\/BuildDocumentation"},"https://hub.docker.com/r/minio/minio":{"title":"https:\/\/hub.docker.com\/r\/minio\/minio","titleInlineContent":[{"text":"https:\/\/hub.docker.com\/r\/minio\/minio","type":"text"}],"type":"link","identifier":"https:\/\/hub.docker.com\/r\/minio\/minio","url":"https:\/\/hub.docker.com\/r\/minio\/minio"},"https://vapor.codes":{"title":"Vapor","titleInlineContent":[{"type":"text","text":"Vapor"}],"type":"link","identifier":"https:\/\/vapor.codes","url":"https:\/\/vapor.codes"},"https://www.swift.org/":{"title":"Swift","titleInlineContent":[{"text":"Swift","type":"text"}],"type":"link","identifier":"https:\/\/www.swift.org\/","url":"https:\/\/www.swift.org\/"},"https://min.io":{"title":"minio","titleInlineContent":[{"type":"text","text":"minio"}],"type":"link","identifier":"https:\/\/min.io","url":"https:\/\/min.io"},"https://github.com/libexif/libexif":{"title":"libexif","titleInlineContent":[{"type":"text","text":"libexif"}],"type":"link","identifier":"https:\/\/github.com\/libexif\/libexif","url":"https:\/\/github.com\/libexif\/libexif"},"doc://VernissageServer/documentation/VernissageServer/HostVernissageWeb":{"title":"Host Vernissage WEB","role":"article","abstract":[{"type":"text","text":"Application which is Web component for Vernissage photos sharing platform."}],"images":[{"type":"card","identifier":"host-web-card.jpg"}],"url":"\/documentation\/vernissageserver\/hostvernissageweb","kind":"article","type":"topic","identifier":"doc:\/\/VernissageServer\/documentation\/VernissageServer\/HostVernissageWeb"},"https://www.swift.org/install/":{"title":"Swift","titleInlineContent":[{"text":"Swift","type":"text"}],"type":"link","identifier":"https:\/\/www.swift.org\/install\/","url":"https:\/\/www.swift.org\/install\/"},"https://libiptcdata.sourceforge.net":{"title":"libiptcdata","titleInlineContent":[{"type":"text","text":"libiptcdata"}],"type":"link","identifier":"https:\/\/libiptcdata.sourceforge.net","url":"https:\/\/libiptcdata.sourceforge.net"},"https://hub.docker.com/repository/docker/mczachurski/vernissage-server":{"title":"docker image","titleInlineContent":[{"text":"docker image","type":"text"}],"type":"link","identifier":"https:\/\/hub.docker.com\/repository\/docker\/mczachurski\/vernissage-server","url":"https:\/\/hub.docker.com\/repository\/docker\/mczachurski\/vernissage-server"},"doc://VernissageServer/documentation/VernissageServer/DockerContainers":{"url":"\/documentation\/vernissageserver\/dockercontainers","kind":"article","type":"topic","title":"Hosting Vernissage in Docker containers","abstract":[{"type":"text","text":"This documentation describes how to run Vernissage in your custom Docker container hosting provider using "},{"code":"docker compose","type":"codeVoice"},{"type":"text","text":"."}],"role":"article","identifier":"doc:\/\/VernissageServer\/documentation\/VernissageServer\/DockerContainers"},"https://docs.vapor.codes/basics/logging/":{"title":"here","titleInlineContent":[{"type":"text","text":"here"}],"type":"link","identifier":"https:\/\/docs.vapor.codes\/basics\/logging\/","url":"https:\/\/docs.vapor.codes\/basics\/logging\/"},"host-web-card.jpg":{"alt":"The profile image for web documentation.","variants":[{"url":"\/images\/VernissageServer\/host-web-card@2x.jpg","traits":["2x","light"]}],"type":"image","identifier":"host-web-card.jpg"},"host-server-card.jpg":{"alt":null,"variants":[{"traits":["2x","light"],"url":"\/images\/VernissageServer\/host-server-card@2x.jpg"}],"type":"image","identifier":"host-server-card.jpg"}}}